<!DOCTYPE html>
</html>
    <head>
        <title>Week 4</title>
    </head>

    <body>
        <h3> Caching </h3>
        <p>
            I've finally finished the caching to work correctly. <br><br>

            Originally, the server would hash all files at startup and store a hash in a BST. 
              That was okay except for when I needed to send the hash to the client. For that, 
              I had to rehash the file and send the hash. When the client reconnected and wanted 
              the hash, it was perfect because it was a simple lookup. So obviously, that had to 
              be changed. <br><br>

            My next aproach was to use the full path of the client's request as the key. Key-Value 
              pairs are the basics of BSTs. Turns out strings dont compare lexographically well. They 
              all just made a long list down the left. Defeats the purpose of a tree right? Anyways,
              had to change it. <br><br>

            My implemented approach was to use the key-value pair method again but with some modifiactions. 
              Now, I store the path, but also a hash for the path and the value. This makes it easy because
              whenever the client asks for the webpage, I only have to hash the filename, not the entire file. 
              That is about 30 characters on average compared to a few hundred thousand to a million. This is 
              probably going to be the final implementation for the caching feature in this server besides
              the implementation of a Merkle Tree. <br><br>

        </p>
        <p>
            Tree <br>

            <pre>
            server
              .vscode
              backups
              webpages
                code
                  2025-04-14
                    server.c
                    server.h
                  2025-04-21
                    server.c
                    server.h
                  2025-04-28
                    node.c
                    node.h
                    server.c
                    server.h
                  2025-05-05
                    node.c
                    node.h
                    server.c
                    server.h
                error_pages
                  400.html
                  403.html 
                  404.html 
                posts
                  2025-04-14
                     entry.html
                  2025-04-21
                     entry.html
                  2025-04-28
                     entry.html
                  2025-05-05
                     entry.html
                capybara.html
                cat.jpeg
                favicon.ico
                icon.html
                index.html
                landing.html
                secret.html
              debug.txt
              Makefile
              node.C
              node.h
              server
              server.c
              server.h
            </pre>
        </p>

        <h5> Issues </h5>
        <p> 

            I have one major issue right now... <br><br>

            1. Client connects and asks for  <br>
            2. Server sends webpages <br>
            3. Client asks over persistent HTTP connection for same webpage <br>
            4. Server sends 304 IF ETag is correct <br>
            5. Client conects asks again <br>
            6. Server doesn't get request <br>
            7. Client Asks for webpage which server doesn't get again <br>
            8. Server doesn't respond <br>
            9. Client asks again <br>
            10. Server sends webpage again. <br> <br>

            I think this is an issue with how I'm managing connections. The reason we use
              select() is to know when a client wants to send new information. I'm checking all fds
              which is wrong. <br><br>

            Probably will work on that week-after-next. <br>
        </p>

        <h5> Merkle Trees </h5>
        <p> 
            Merkle Trees are on my list but will be a little before I get to it. <br>
        </p>
    </body>
</html>
